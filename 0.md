## 0 摘要

## 1 引言

最近几十年来，量子信息和量子计算领域发展迅猛。起初，由于其不直观和本质上是概率性的特点，量子信息被许多知名物理学家忽视和质疑。然而，随着时间的推移，量子信息逐渐引起人们的关注，并成为我们今天熟知的富有潜力的领域。在发展量子算法方面，人们做出了令人难以置信的工作和研究，这些算法在计算上具有比已知最佳经典算法更大的优势；同时，在构建和改进承载和处理这些复杂量子系统所需的架构方面也取得了重大进展。从1998年开发出的第一台能工作的2比特量子计算机，我们现在已经能够生产现代的噪声中间尺度量子时代（NISQ）设备，这些设备虽然不够容错，但仍能承载数十个量子比特并执行高度复杂的算法。然而，什么是量子计算机？现代的NISQ设备如何用于存储和处理量子信息？它们是否能够抵抗错误和噪声？如果可以，如何实现？

自从20世纪中期诞生以来，核磁共振（NMR）已被证明是一种简单而强大的工具，广泛应用于各个领域。在过去几十年里，NMR已经为物理学和化学领域多次赢得了诺贝尔奖，它为探索和理解复杂的化学结构铺平了道路，使医学成像中的MRI现代化，并最近在量子计算中作为基本工具而受到关注。凭借其悠久而丰富的历史，毫不奇怪NMR今天仍然被广泛应用和深入研究。

在本文中，我们将通过展示一个2比特耦合核磁共振系统的工作原理来试图回答所有这些问题。具体而言，我们说明了如何使用耦合自旋系统作为量子计算机，利用基本信息处理技术和脉冲序列来初始化量子态。

本文的结构如下。在本文的第二节中，我们将介绍Nuclear Magnetic Resonance。在第三节中，我们将简要概述Spin Coupled NMR Spectroscopy of Chloroform和量子算符形式主义背后的必要理论。第四节将详细介绍使用核磁共振脉冲实现基本量子门的理论。此外，我们还将描述一种强大的技术，可以轻松地准备对小旋转误差具有抵抗力的“伪”纯量子态。第五节将进行总结。

## 2 Nuclear Magnetic Resonance

正如其名称所示，核磁共振（NMR）是一种物理现象，其中具有非零自旋磁矩的核在强大且恒定的磁场下受到弱的振荡磁场干扰，可以在共振频率附近或接近共振频率的弱振荡磁场中扰动核自旋的方向。这些射频脉冲可以用于操纵样品的净磁化强度的方向，以获得样品固有核的共振频率和弛豫率等各种性质。样品在磁场中演化和进动时的磁化频谱可以用作研究人员确定样品组成和分子结构信息的蓝图，而弛豫率可以用来确定样品的性质，如粘度、场非均匀性、温度等。此外，核磁共振技术被应用于现代磁共振成像（MRI），研究人员可以在不侵入性解剖的情况下探测有机材料。毫不奇怪，核磁共振是一种强大而简单的机制，既可以用于对核磁性的深入理解，也可以用于探索各种化学样品的性质。

### A. 核磁性

核磁共振是一种物理现象，通过在共振附近施加强大的恒定磁场并受到较弱的振荡磁场干扰，可以探测核的信息。为了对应用的磁场做出响应，核必须具有磁矩和角动量。稳定核的磁矩可以用以下方式描述：

$$
\vec{\mu}=\gamma \vec{J}
$$

其中，$\gamma$ 是旋磁比，$\vec{J}$ 是核角动量。根据量子力学，核角动量以$\hbar$的单位量子化：

$$
\vec{J}=\hbar l
$$

其中 $l$ 是核的自旋。许多稳定核具有非零自旋，因此可以有效地使用核磁共振技术进行探测。本文中探测的样品主要由氢核组成，即单个质子。质子是自旋为1/2的粒子，在恒定磁场 $B_{0}$ 下具有两个能级本征态：自旋“上”态，磁量子数为 $m_{l}=+1/2$，和自旋“下”态，磁量子数为 $m_{l}=-1/2$。这两个态之间的能量差为

$$
\Delta U=\gamma \hbar B_{0} \equiv \hbar \omega_{0}
$$

其中，$\omega_{0}=\gamma B_{0}$ 是跃迁或拉莫频率。在强大的恒定磁场下，样品中核的磁矩将与磁场保持一致，形成与外加磁场平行的净磁化强度 M。

### B. $\pi$和$\pi/2$脉冲

在外部磁场 $\vec{B}$ 中，磁矩将经历一个力矩

$$
\vec{\tau}=\vec{\mu} \times \vec{B}=\frac{d \vec{J}}{d t}
$$

导致磁矩绕着拉莫频率 $\omega_{0}$ 在外部磁场中进动。在典型的核磁共振实验中，样品磁化强度在恒定外部磁场中的进动可以用于探测样品组成、弛豫时间、能级跃迁频率等。然而，根据上述关于磁化强度的讨论，磁化强度总是沿任何外部磁场方向对齐，因此自然不会发生进动。为了使磁化强度在外部磁场周围产生非平凡的进动，首先必须将其从恒定磁场轴上旋转。在核磁共振实验中，通常通过在与恒定外部磁场 $B_{0} \hat{k}$ 垂直的方向施加振荡的圆极化无线电频率（RF）脉冲来实现。在固定在 $\hat{i}$ 轴上的旋转参考系中，该参考系中观察到的净磁场为

$$
\vec{B}_{eff}=B_{1} \hat{i}+\left(B_{0}-\frac{\omega}{\gamma}\right) \hat{k}
$$

对于核的共振频率 $\omega=\omega_{0}=\gamma B_{0}$，有效磁场完全位于 $\hat{i}$ 轴上。因此，在脉冲持续时间为 t 的情况下，样品的磁化强度将有效地围绕 $\hat{i}$ 轴进动。对于持续时间为 t 的 RF 脉冲，磁化强度将以角度 $\omega_{1} t$ 旋转，其中

$$
\omega_{1}=\gamma B_{1}
$$

是关于应用的 $B_{1}$ 磁场的进动频率。磁化强度围绕 $\hat{i}$ 轴旋转角度为 $\frac{\pi}{2}$（$\pi$）的脉冲称为 $\frac{\pi}{2}$（$\pi$）脉冲。为了简化表示，本文中余下的部分将选择一个坐标系，其中 $\hat{k}=\hat{z}$ 和 $\hat{i}=\hat{x}$。

## 3 Spin Coupled NMR Spectroscopy of Chloroform

我们将使用一台Magritek NMR Spinsolve设备和稀释了丙酮的氯仿样品，$\mathrm{CHCl}_{3}$，其中包含耦合的自旋$1/2$的${ }^{1} H$和${ }^{13} \mathrm{C}$核，提供关于单自旋系统的NMR矢量模型的完整而严格的处理。然而，对于耦合自旋系统，矢量模型的处理很快就会失效。相反，为了完全捕捉耦合自旋系统的微妙之处，需要引入并建立量子算符框架。

### A. 2自旋耦合核磁共振

未耦合自旋系统在磁化向量模型下，所有非零自旋的不同核都带有一定的磁矩，它们的矢量和形成系统的磁化。在一个恒定的外磁场$B_{0}$作用下，系统中各个核的磁化在磁场轴周围以拉莫尔频率进行进动。

$$
\nu=\gamma B_{0}
$$

其中$\gamma$是核的旋磁比。对于一个由两个未耦合自旋$1/2$粒子组成的样品，这些进动磁化产生的频谱将在各自的拉莫尔频率处形成两个洛仑兹峰，峰宽与它们的$T_{2}^{\star}$弛豫时间的倒数成比例。然而，对于耦合的系统，这个矢量模型失效，我们必须求助于量子处理来完全捕捉动力学过程。为了了解耦合如何影响系统，考虑一个由两个异核自旋（不同类型的核）组成的样品，每个自旋具有拉莫尔频率$\nu_{1}$和$\nu_{2}$，耦合常数为$J_{12}$。自旋态的能量不仅依赖于每个单独自旋，还依赖于它们之间的耦合，并可以用以下形式（其中$\hbar=1$）进行描述：

$$
E_{m_{1} m_{2}}=m_{1} \nu_{1}+m_{2} \nu_{2}+m_{1} m_{2} J_{12}
$$

这里$m_{1}, m_{2}$分别是自旋1和自旋2的自旋量子数，对于自旋向下和向上，它们取$-\frac{1}{2}, \frac{1}{2}$的值。假设核的自旋上升和下降的本征态分别标记为$\alpha$和$\beta$，例如状态$\alpha \beta$是第一个和第二个自旋分别为自旋上升和自旋下降的本征态。很容易看出，这些本征态的能量如表1所示。

现在，量子选择定则只允许$m$变化为$\pm 1$的跃迁。根据表2，可以很容易地看出有4个允许的跃迁及其对应的能量变化。

这些跃迁及其相应的能量在频率上形成4个峰，其频率等于它们的跃迁频率，与无耦合情况下通常的2个峰不同。这些峰位于两个自旋的拉莫尔频率处，但被频率$J_{12}$分成两个双重峰。显然，磁化的矢量模型处理是不完全的，我们必须求助于更严格的量子处理方法。

| Spin State        | Energy                                                          |
| ----------------- | --------------------------------------------------------------- |
| $\alpha \alpha$ | $\frac{1}{2} \nu_{1}+\frac{1}{2} \nu_{2}+\frac{1}{4} J_{12}$  |
| $\alpha \beta$  | $\frac{1}{2} \nu_{1}-\frac{1}{2} \nu_{2}-\frac{1}{4} J_{12}$  |
| $\beta \alpha$  | $-\frac{1}{2} \nu_{1}+\frac{1}{2} \nu_{2}-\frac{1}{4} J_{12}$ |
| $\beta \beta$   | $-\frac{1}{2} \nu_{1}-\frac{1}{2} \nu_{2}+\frac{1}{4} J_{12}$ |

\begin{tabular}{|c|c|}
\hline Spin State & Energy \\
\hline \hline$\alpha \alpha$ & $\frac{1}{2} \nu_{1}+\frac{1}{2} \nu_{2}+\frac{1}{4} J_{12}$ \\
$\alpha \beta$ & $\frac{1}{2} \nu_{1}-\frac{1}{2} \nu_{2}-\frac{1}{4} J_{12}$ \\
$\beta \alpha$ & $-\frac{1}{2} \nu_{1}+\frac{1}{2} \nu_{2}-\frac{1}{4} J_{12}$ \\
$\beta \beta$ & $-\frac{1}{2} \nu_{1}-\frac{1}{2} \nu_{2}+\frac{1}{4} J_{12}$ \\
\hline
\end{tabular}

表格I. 耦合的2自旋本征态的能量

TABLE I. Energies of coupled 2 spin eigenstates

| Transition                                 | $\Delta E$                   |
| ------------------------------------------ | ------------------------------ |
| $\alpha \alpha \rightarrow \beta \alpha$ | $\nu_{1}+\frac{1}{2} J_{12}$ |
| $\alpha \beta \rightarrow \beta \beta$   | $\nu_{1}-\frac{1}{2} J_{12}$ |
| $\alpha \alpha \rightarrow \alpha \beta$ | $\nu_{2}+\frac{1}{2} J_{12}$ |
| $\beta \alpha \rightarrow \beta \beta$   | $\nu_{2}-\frac{1}{2} J_{12}$ |

\begin{tabular}{|c|c|}
\hline Transition & $\Delta E$ \\
\hline \hline$\alpha \alpha \rightarrow \beta \alpha$ & $\nu_{1}+\frac{1}{2} J_{12}$ \\
$\alpha \beta \rightarrow \beta \beta$ & $\nu_{1}-\frac{1}{2} J_{12}$ \\
$\alpha \alpha \rightarrow \alpha \beta$ & $\nu_{2}+\frac{1}{2} J_{12}$ \\
$\beta \alpha \rightarrow \beta \beta$ & $\nu_{2}-\frac{1}{2} J_{12}$ \\
\hline
\end{tabular}

表格II. 耦合的2自旋允许跃迁的能量

TABLE II. Energies of allowed coupled 2 spin transitions

### B. 量子处理

我们可以将核磁共振视为对系统进行测量，而不是将其视为演化的磁化向量。在量子力学中，测量通过测量算符来描述，对于自旋为$1/2$的粒子，有三个测量算符$I_{x}$，$I_{y}$和$I_{z}$，其中

$$
\begin{gathered}
I_{x}=\frac{\hbar}{2} \sigma_{x}=\frac{\hbar}{2}\left(\begin{array}{ll}
0 & 1 \\
1 & 0
\end{array}\right) \\
I_{y}=\frac{\hbar}{2} \sigma_{y}=\frac{\hbar}{2}\left(\begin{array}{cc}
0 & -i \\
i & 0
\end{array}\right) \\
I_{z}=\frac{\hbar}{2} \sigma_{z}=\frac{\hbar}{2}\left(\begin{array}{cc}
1 & 0 \\
0 & -1
\end{array}\right)
\end{gathered}
$$

分别对应于磁化的$\mathrm{x}$，$\mathrm{y}$和$\mathrm{z}$分量。本文中我们将设置$\hbar=1$。作为量子算符，它们按照通常的方式随时间演化。特别地，算符$M$在哈密顿量$\mathrm{H}$下的时间演化由以下公式给出：

$$
M(t)=e^{-i H t} M\left(t_{\text {init }}\right) e^{i H t}
$$

例如，在核磁共振的情况下，如果沿$\mathrm{z}$方向对磁化施加一个$\mathrm{x}$脉冲，持续时间为$\mathrm{t}$，我们有$H=\omega I_{x}$和$M\left(t_{\text {init }}\right)=I_{z}$，使得在某个较晚的时间$\mathrm{t}$，算符为

$$
M(t)=e^{-i \omega I_{x} t} I_{z} e^{i \omega I_{x} t}=\cos (\omega t) I_{z}-\sin (\omega t) I_{y}
$$

事实上，利用泰勒展开和自旋算符的对易关系，各种脉冲下算符的时间演化可以简洁地总结如表格III所示。

量子算符形式主义地推广到具有两个自旋的系统，每个自旋都有自己的磁化算符。特别对于核磁共振，我们只关注在哈密顿量$2 \pi J_{12} I_{1 z} I_{2 z}$下的演化，该哈密顿量描述自然的、无脉冲的绕$\mathrm{z}$轴（外磁场的方向）的进动。哈密顿量中的$2 \pi$因子来自于耦合常数通常以赫兹为单位，而拉莫尔频率以$\mathrm{rad} / \mathrm{s}$为单位。相关的测量算符及其相应的时间演化在表格IV中得到了简洁的总结。

| $M_{\text {init }}$ | $\mathrm{H}$   | $M(t)$                                         |
| --------------------- | ---------------- | ------------------------------------------------ |
| $I_{y}$             | $\omega I_{x}$ | $\cos (\omega t) I_{y}+\sin (\omega t) I_{z}$  |
| $I_{z}$             | $\omega I_{x}$ | $\cos (\omega t) I_{z}-\sin (\omega t) I_{y}$  |
| $-I_{y}$            | $\omega I_{x}$ | $-\cos (\omega t) I_{y}-\sin (\omega t) I_{z}$ |
| $-I_{z}$            | $\omega I_{x}$ | $-\cos (\omega t) I_{z}+\sin (\omega t) I_{y}$ |
| $I_{x}$             | $\omega I_{y}$ | $\cos (\omega t) I_{x}-\sin (\omega t) I_{z}$  |
| $I_{z}$             | $\omega I_{y}$ | $\cos (\omega t) I_{z}+\sin (\omega t) I_{x}$  |
| $-I_{x}$            | $\omega I_{y}$ | $-\cos (\omega t) I_{x}+\sin (\omega t) I_{z}$ |
| $-I_{z}$            | $\omega I_{y}$ | $-\cos (\omega t) I_{z}-\sin (\omega t) I_{x}$ |
| $I_{x}$             | $\omega I_{z}$ | $\cos (\omega t) I_{x}+\sin (\omega t) I_{y}$  |
| $I_{y}$             | $\omega I_{z}$ | $\cos (\omega t) I_{y}-\sin (\omega t) I_{x}$  |
| $-I_{x}$            | $\omega I_{z}$ | $-\cos (\omega t) I_{x}-\sin (\omega t) I_{y}$ |
| $-I_{y}$            | $\omega I_{z}$ | $\cos (\omega t) I_{y}+\sin (\omega t) I_{x}$  |

\begin{tabular}{|c|c|c|}
\hline$M_{\text {init }}$ & $\mathrm{H}$ & $M(t)$ \\
\hline \hline$I_{y}$ & $\omega I_{x}$ & $\cos (\omega t) I_{y}+\sin (\omega t) I_{z}$ \\
$I_{z}$ & $\omega I_{x}$ & $\cos (\omega t) I_{z}-\sin (\omega t) I_{y}$ \\
$-I_{y}$ & $\omega I_{x}$ & $-\cos (\omega t) I_{y}-\sin (\omega t) I_{z}$ \\
$-I_{z}$ & $\omega I_{x}$ & $-\cos (\omega t) I_{z}+\sin (\omega t) I_{y}$ \\
$I_{x}$ & $\omega I_{y}$ & $\cos (\omega t) I_{x}-\sin (\omega t) I_{z}$ \\
$I_{z}$ & $\omega I_{y}$ & $\cos (\omega t) I_{z}+\sin (\omega t) I_{x}$ \\
$-I_{x}$ & $\omega I_{y}$ & $-\cos (\omega t) I_{x}+\sin (\omega t) I_{z}$ \\
$-I_{z}$ & $\omega I_{y}$ & $-\cos (\omega t) I_{z}-\sin (\omega t) I_{x}$ \\
$I_{x}$ & $\omega I_{z}$ & $\cos (\omega t) I_{x}+\sin (\omega t) I_{y}$ \\
$I_{y}$ & $\omega I_{z}$ & $\cos (\omega t) I_{y}-\sin (\omega t) I_{x}$ \\
$-I_{x}$ & $\omega I_{z}$ & $-\cos (\omega t) I_{x}-\sin (\omega t) I_{y}$ \\
$-I_{y}$ & $\omega I_{z}$ & $\cos (\omega t)-I_{y}+\sin (\omega t) I_{x}$ \\
\hline
\end{tabular}

表格III. 在不同脉冲下，自旋$1 / 2$算符的时间演化。与磁化算符同轴的脉冲不会影响算符。

Table III. Time evolution of spin-$1/2$ operators under different pulses. Pulses aligned with the magnetization operator do not affect the operator. 

TABLE III. Time evolution of spin $1 / 2$ operators under various pulses. Pulses along the same axis as the magnetization operator does not affect the operator.

| $M_{\text {init }}$  | $M(t)$                                                                                     |
| ---------------------- | -------------------------------------------------------------------------------------------- |
| $I_{1 x}$            | $\cos \left(\pi J_{12} t\right) I_{1 x}+2 \sin \left(\pi J_{12} t\right) I_{1 y} I_{2 z}$  |
| $-I_{1 x}$           | $-\cos \left(\pi J_{12} t\right) I_{1 x}-2 \sin \left(\pi J_{12} t\right) I_{1 y} I_{2 z}$ |
| $I_{1 y}$            | $\cos \left(\pi J_{12} t\right) I_{1 y}-2 \sin \left(\pi J_{12} t\right) I_{1 x} I_{2 z}$  |
| $-I_{1 y}$           | $-\cos \left(\pi J_{12} t\right) I_{1 y}+2 \sin \left(\pi J_{12} t\right) I_{1 x} I_{2 z}$ |
| $2 I_{1 x} I_{2 z}$  | $\cos \left(\pi J_{12} t\right) 2 I_{1 x} I_{2 z}+\sin \left(\pi J_{12} t\right) I_{1 y}$  |
| $-2 I_{1 x} I_{2 z}$ | $-\cos \left(\pi J_{12} t\right) 2 I_{1 x} I_{2 z}-\sin \left(\pi J_{12} t\right) I_{1 y}$ |
| $2 I_{1 y} I_{2 z}$  | $\cos \left(\pi J_{12} t\right) 2 I_{1 y} I_{2 z}-\sin \left(\pi J_{12} t\right) I_{1 x}$  |
| $-2 I_{1 y} I_{2 z}$ | $-\cos \left(\pi J_{12} t\right) 2 I_{1 y} I_{2 z}+\sin \left(\pi J_{12} t\right) I_{1 x}$ |

\begin{tabular}{|c|c|}
\hline$M_{\text {init }}$ & $M(t)$ \\
\hline \hline$I_{1 x}$ & $\cos \left(\pi J_{12} t\right) I_{1 x}+2 \sin \left(\pi J_{12} t\right) I_{1 y} I_{2 z}$ \\
$-I_{1 x}$ & $-\cos \left(\pi J_{12} t\right) I_{1 x}-2 \sin \left(\pi J_{12} t\right) I_{1 y} I_{2 z}$ \\
$I_{1 y}$ & $\cos \left(\pi J_{12} t\right) I_{1 y}-2 \sin \left(\pi J_{12} t\right) I_{1 x} I_{2 z}$ \\
$-I_{1 y}$ & $-\cos \left(\pi J_{12} t\right) I_{1 y}+2 \sin \left(\pi J_{12} t\right) I_{1 x} I_{2 z}$ \\
$2 I_{1 x} I_{2 z}$ & $\cos \left(\pi J_{12} t\right) 2 I_{1 x} I_{2 z}+\sin \left(\pi J_{12} t\right) I_{1 y}$ \\
$-2 I_{1 x} I_{2 z}$ & $-\cos \left(\pi J_{12} t\right) 2 I_{1 x} I_{2 z}-\sin \left(\pi J_{12} t\right) I_{1 y}$ \\
$2 I_{1 y} I_{2 z}$ & $\cos \left(\pi J_{12} t\right) 2 I_{1 y} I_{2 z}-\sin \left(\pi J_{12} t\right) I_{1 x}$ \\
$-2 I_{1 y} I_{2 z}$ & $-\cos \left(\pi J_{12} t\right) 2 I_{1 y} I_{2 z}+\sin \left(\pi J_{12} t\right) I_{1 x}$ \\
\hline
\end{tabular}

表格 IV. 在哈密顿量 $H=2 \pi J_{12} I_{1 z} I_{2 z}$ 下，两个自旋 $1/2$ 算符的时间演化。这些跃迁自然适用于第二个自旋，其中第一个和第二个自旋的轴被简单交换。

Table IV. Time evolution of two spin-$1/2$ operators under the Hamiltonian $H=2 \pi J_{12} I_{1 z} I_{2 z}$. These transitions naturally apply to the second spin, where the axes of the first and second spins are simply interchanged.

TABLE IV. Time evolution of 2 spin $1 / 2$ operators under the Hamiltonian $H=2 \pi J_{12} I_{1 z} I_{2 z}$. These transitions apply naturally to the second spin in which the axes of the first and second spins are simply swapped. 

## 4 Quantum Computing with NMR

### A. 预备知识

对于一个由概率$p_i$准备的纯量子态$\left|\psi_{i}\right\rangle$的集合，其中$\sum_{i} p_{i}=1$，该系统可以用密度矩阵$\rho$来描述，其中

$$
\rho=\sum_{i} p_{i}\left|\psi_{i}\right\rangle\left\langle\psi_{i}\right|
$$

对于一个n量子比特系统，$\rho$是一个$2^{n} \times 2^{n}$的矩阵，其中i,j项为$\langle i|\rho| j\rangle$，$|i\rangle,|j\rangle$是该系统的第i,j基态。应用算符$\mathrm{U}$，密度矩阵会演化为

$$
\rho^{\prime}=U \rho U^{\dagger}
$$

### B. 热平衡态

对于我们在氯仿$\mathrm{CHCl}_{3}$中的耦合两量子比特系统，其哈密顿量为

$$
H=\Omega_{p} S_{z}^{(1)} I^{(2)}+\Omega_{c} I^{(1)} S_{z}^{(2)}+\frac{2 \pi J}{\hbar} S_{z}^{(1)} S_{z}^{(2)}
$$

其中$\Omega_{c}, \Omega_{p}$分别是碳和质子核的有效拉莫尔频率，$S_{i}=\frac{\hbar}{2} \sigma_{i}$是自旋$1 / 2$算符，$J$是碳和质子核之间的耦合常数。对于哈密顿量H，热平衡态为

$$
\rho_{\text {thermal }}=\frac{e^{\beta H}}{\operatorname{Tr}\left(e^{\beta H}\right)}
$$

对于$\beta=\frac{1}{k_{b} T}$。

对于使用相应通道上的最终采集$\frac{\pi}{2}$脉冲获得数据的NMR实验，可以证明对于一个形如的密度矩阵：

$$
\left(\begin{array}{llll}
a & 0 & 0 & 0 \\
0 & b & 0 & 0 \\
0 & 0 & c & 0 \\
0 & 0 & 0 & d
\end{array}\right)
$$

FID峰的积分为质子的$a-c$和$b-d$，碳的$a-b$和$c-d$。实际上在实际中使用碳通道的采集脉冲的FID光谱具有大致相同的幅度峰值。FID光谱幅度和理论预测值之间的差异是NMR设备接收信号放大的结果，以便设备可以可靠地测量原本较小的电压。因此我们可以只关注峰值幅度和积分的相对比例，因为这不会影响结果。

### C. 时间平均

在量子实验中，我们通常只对初始化和演化纯态感兴趣，通常是计算基态。然而，氯仿的热平衡态不是纯态，而是混合态。我们可以使用时间平均而不是使用复杂的脉冲序列来准备“伪纯”态。时间平均的前提是进行3个单独的实验，在进行平均结果之前，首先使用三个排列幺正算符$U_{0}, U_{1}, U_{2}$之一对密度矩阵的元素进行置换。时间平均的密度矩阵将表现为纯态，比如$|00\rangle$。更准确地说，排列幺正算符为$U_{0}=I$，单位矩阵，

$$
U_{1}=\left(\begin{array}{llll}
1 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0
\end{array}\right)
$$

and

$$
U_{2}=\left(\begin{array}{llll}
1 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 \\
0 & 1 & 0 & 0
\end{array}\right)
$$

将这些置换矩阵应用于的密度矩阵

$$
\left(\begin{array}{llll}
a & 0 & 0 & 0 \\
0 & b & 0 & 0 \\
0 & 0 & c & 0 \\
0 & 0 & 0 & d
\end{array}\right)
$$

我们发现：

$$
\begin{aligned}
& \rho_{0}=U_{0} \rho U_{0}^{\dagger}=\left(\begin{array}{llll}
a & 0 & 0 & 0 \\
0 & b & 0 & 0 \\
0 & 0 & c & 0 \\
0 & 0 & 0 & d
\end{array}\right) \\
& \rho_{1}=U_{1} \rho U_{1}^{\dagger}=\left(\begin{array}{llll}
a & 0 & 0 & 0 \\
0 & d & 0 & 0 \\
0 & 0 & b & 0 \\
0 & 0 & 0 & c
\end{array}\right) \\
& \rho_{2}=U_{2} \rho U_{2}^{\dagger}=\left(\begin{array}{llll}
a & 0 & 0 & 0 \\
0 & c & 0 & 0 \\
0 & 0 & d & 0 \\
0 & 0 & 0 & b
\end{array}\right)
\end{aligned}
$$

它们的平均值是

$$
\begin{align}
\rho_{\text {pure }} &= \sum_{i} \rho_{i} \\
&= (4 a - 1)\left(\begin{matrix}1 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0\end{matrix}\right) \\
&+ (1 - a)\left(\begin{matrix}1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1\end{matrix}\right)
\end{align}
$$

在NMR中，形如$\operatorname{tr}(M)=0$的观察量$M$是唯一可以被检测到的，因此在对它的伪纯态进行测量时，

$$
\begin{aligned}
\operatorname{tr}\left(\rho_{\text {pure }} M\right) & =(4 a-1) \operatorname{tr}(|00\rangle\langle 00| M)+(1-a) \operatorname{tr}(M) \\
& =(4 a-1) \operatorname{tr}(|00\rangle\langle 00| M)
\end{aligned}
$$

我们实际上是在纯态上测量了可观察量$M$，只是乘以了一些比例。

### D. 脉冲和门

现在，我们已经了解了在NMR中如何初始化伪纯态，让我们讨论如何应用NMR脉冲来演化态。从我们之前对偶合NMR光谱的工作中，我们发现在Hamiltonian $\mathrm{H}$ 下，NMR状态$\rho$在时间$t$内演化为：

$$
\rho^{\prime}=e^{-i H t / \hbar} \rho e^{i H t / \hbar}
$$

这相当于在$\rho^{\prime}=U \rho U^{\dagger}$中引入密度矩阵形式主义，对于$U=e^{-i H t / \hbar}$。

在典型的NMR实验中，状态可能通过在$\mathrm{x}$轴上脉冲，$\mathrm{y}$轴上脉冲或通过围绕外部B场的自然进动演化。在我们之前的工作中，我们表明，幅度为$\mathrm{A}$的轴i脉冲的哈密顿量为$\mathrm{H}$，单位为$\mathrm{dB}$，即：

$$
H_{i}(A)=\Omega \sqrt{10^{A / 10}} S_{i}
$$

其中，回想一下，$S_{i}=\frac{\hbar}{2} \sigma_{i}$，$\Omega$是核的有效Larmor频率。当应用时间$t$时，这对应于一个形式为

$$
U_{i}(t)=e^{-i H t / \hbar}=e^{-i \frac{\theta}{2} \sigma_{i}}
$$

的酉变换，其中$\theta=\Omega 10^{A / 10} t$。请注意，沿轴i的脉冲等效于沿同一轴旋转角度$\theta$。特别地，沿$\mathrm{x}$轴的脉冲对应于：

$$
U_{x}=e^{-i \frac{\theta}{2} \sigma_{x}}=\left(\begin{array}{cc}
\cos (\theta / 2) & -i \sin (\theta / 2) \\
-i \sin (\theta / 2) & \cos (\theta / 2)
\end{array}\right)
$$

而沿y轴的脉冲对应于：

$$
U_{y}=e^{-i \frac{\theta}{2} \sigma_{y}}=\left(\begin{array}{cc}
\cos (\theta / 2) & -\sin (\theta / 2) \\
\sin (\theta / 2) & \cos (\theta / 2)
\end{array}\right)
$$

最后，在没有任何脉冲的情况下，状态会自然地围绕外部磁场进动，并具有以下哈密顿量：

$$
H=\frac{2 \pi J}{\hbar} S_{z}^{(1)} S_{z}^{(2)}
$$

对于时间$\tau$的自然进化，这对应于以下形式的酉变换：

$$
U(\tau)=e^{-i H t / \hbar}=e^{-i \frac{\theta}{2} \sigma_{z}^{(1)} \sigma_{z}^{(2)}}
$$

这恰好是围绕$\mathrm{zz}$旋转$\theta=\pi J t$的旋转。为了完整起见，以矩阵形式表示，

$$
U(\tau)=e^{-i \frac{\theta}{2} \sigma_{z}^{(1)} \sigma_{z}^{(2)}}=\left(\begin{array}{cccc}
e^{-i \theta / 2} & 0 & 0 & 0 \\
0 & e^{i \theta / 2} & 0 & 0 \\
0 & 0 & e^{i \theta / 2} & 0 \\
0 & 0 & 0 & e^{-i \theta / 2}
\end{array}\right)
$$

因此，在核磁共振中，脉冲和自由演化简单地对应于关于相应轴的旋转。因此，将量子门应用于系统的过程对应于施加正确的脉冲以应用这些旋转。使用这些结果，让我们看看如何在NMR实验中应用各种量子门：

#### 1. 伪哈达玛门

伪哈达玛门的形式为

$$
h=\left(\begin{array}{cc}
1 & 1 \\
-1 & 1
\end{array}\right)
$$

可以通过$\frac{\pi}{2}$的y轴旋转，实现该门，即

$$
h=\left(\frac{\pi}{2}\right)_{y}
$$

其中，我们的符号$(\theta)_{i}$表示在i轴上的$\theta$脉冲。

伪哈达玛门与真正的Hadamard的区别在于，这个算符不是自反的，为了得到其逆算符，我们可以使用相同的脉冲，但是加上负号，$h^{-1}=(\pi/2)_{\bar{y}}$

#### 2. 哈达玛门

Hadamard 门

$$
H=\left(\begin{array}{cc}
1 & 1 \\
1 & -1
\end{array}\right)
$$

可通过三个脉冲准确地应用，直到全局相位。具体来说，可以使用以下三个脉冲实现 Hadamard 门：

$$
H=\left(\frac{\pi}{4}\right)_{y}-(\pi)_{x}-\left(\frac{\pi}{2}\right)_{\bar{y}}
$$

其中 $\bar{y}$ 对应于沿着 $-y$ 方向的脉冲。

#### 3. 控制Z门

$$
C Z=\left(\begin{array}{cccc}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & -1
\end{array}\right)
$$

一个控制Z门可以只使用3个旋转来实现，即 $\left(\frac{\pi}{2}\right)_{\bar{z} 1}-\left(\frac{\pi}{2}\right)_{\bar{z} 2}-$ $\left(\frac{\pi}{2}\right)_{z 1 z 1}$。然而，这需要在 $\mathrm{z}$ 轴上施加脉冲，而这是不允许的。相反，我们可以使用以下变换将其转化为仅沿 $\mathrm{x}$ 和 $\mathrm{y}$ 方向的旋转：

$$
(\theta)_{z}=\left(\frac{\pi}{2}\right)_{\bar{x}}-(\theta)_{y}-\left(\frac{\pi}{2}\right)_{x}
$$

因此，完整的脉冲序列为

$C Z=\left(\frac{\pi}{2}\right)_{\bar{x} 1}-\left(\frac{\pi}{2}\right)_{\bar{y} 1}-\left(\frac{\pi}{2}\right)_{x 1}-\left(\frac{\pi}{2}\right)_{\bar{x} 2}-\left(\frac{\pi}{2}\right)_{\bar{y} 2}-\left(\frac{\pi}{2}\right)_{x 2}-\tau$

其中$\tau$仍然是一个自然延迟，延迟时间为$\frac{1}{2J}$。

#### 4. 近似CNOT门

$$
C \tilde{N} O T=\left(\begin{array}{cccc}
-i & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 0 & -1 \\
0 & 0 & -i & 0
\end{array}\right)
$$

一个近似的CNOT门可以通过3个脉冲实现：

$$
C \tilde{N} O T=\left(\frac{\pi}{2}\right)_{y 2}-\tau-\left(\frac{\pi}{2}\right)_{x 2}
$$

其中，$x_{2}$和$y_{2}$分别表示第二个量子比特在$\mathrm{x}$和$\mathrm{y}$轴上的脉冲，$\tau$代表自然演化在时间$\frac{1}{2J}$内，这等价于$\frac{\pi}{2}$的$\mathrm{zz}$旋转。

#### 5. $C N O T$

$$
C N O T=\left(\begin{array}{llll}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & 1 & 0
\end{array}\right)
$$

一种精确的CNOT门可以通过在qubit 2上应用CZ门以及在其前后应用伪Hadamard门来实现。使用以上结果，这对应于以下脉冲序列：

$$
\begin{aligned}
C N O T & =h-C Z-h^{-1} \\
& =\left(\frac{\pi}{2}\right)_{\bar{y} 2}-\left(\frac{\pi}{2}\right)_{\bar{x} 1}-\left(\frac{\pi}{2}\right)_{\bar{y} 1}-\left(\frac{\pi}{2}\right)_{x 1}-\left(\frac{\pi}{2}\right)_{\bar{x} 2} \\
& -\left(\frac{\pi}{2}\right)_{\bar{y} 2}-\left(\frac{\pi}{2}\right)_{x 2}-\tau-\left(\frac{\pi}{2}\right)_{y 2}
\end{aligned}
$$

#### 6. 置换幺正算符

最后，上面讨论的置换酉矩阵$U_{1}$和$U_{2}$可以使用相应的脉冲序列来实现：

$$
\begin{aligned}
& U_{1}=\left(\frac{\pi}{2}\right)_{y 1}-\tau-\left(\frac{\pi}{2}\right)_{x 1}-\left(\frac{\pi}{2}\right)_{y 2}-\tau-\left(\frac{\pi}{2}\right)_{x 2} \\
& U_{2}=\left(\frac{\pi}{2}\right)_{y 2}-\tau-\left(\frac{\pi}{2}\right)_{x 2}-\left(\frac{\pi}{2}\right)_{y 1}-\tau-\left(\frac{\pi}{2}\right)_{x 1}
\end{aligned}
$$

其中 $\tau$ 是一个自然延迟，由时间 $\frac{1}{2J}$ 给出。在矩阵形式下，这些脉冲序列对应于：

$$
\begin{aligned}
U_{1} & =\left(\begin{array}{cccc}
-i & 0 & 0 & 0 \\
0 & 0 & 0 & -i \\
0 & -1 & 0 & 0 \\
0 & 0 & 1 & 0
\end{array}\right) \\
U_{2} & =\left(\begin{array}{cccc}
-i & 0 & 0 & 0 \\
0 & 0 & -1 & 0 \\
0 & 0 & 0 & -i \\
0 & 1 & 0 & 0
\end{array}\right)
\end{aligned}
$$

这些旋转操作的形式与上面描述的置换幺正有些不同，但这些相位在演化量子态时会被抵消。

## 5 Conclusion
